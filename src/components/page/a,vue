<template>
    <div class="tree">
        <div class="wei_search">
            <el-form :model="ruleForm" :inline="true" ref="ruleForm" class="demo-ruleForm">
                <el-form-item label="部门" prop="dept">
                    <el-select v-model="ruleForm.dept" placeholder="请选择部门" clearable size="small" style="width: 170px">
                        <el-option v-for="dict in deptOption" :key="dict.deptValue" :label="dict.deptLabel" :value="dict.deptValue" />
                    </el-select>
                </el-form-item>
                <el-form-item label="展示类型" prop="showType">
                    <el-select v-model="ruleForm.showType" placeholder="请选择职级" clearable size="small" style="width: 170px">
                        <el-option v-for="dict in showOption" :key="dict.showValue" :label="dict.showLabel" :value="dict.showValue" />
                    </el-select>
                </el-form-item>
                <el-form-item label="显示类型" prop="type">
                    <el-select
                        v-model="ruleForm.type"
                        placeholder="请选择职级"
                        clearable
                        size="small"
                        style="width: 170px"
                        @change="ChangeType"
                    >
                        <el-option v-for="dict in typeOption" :key="dict.typeValue" :label="dict.typeLabel" :value="dict.typeValue" />
                    </el-select>
                </el-form-item>

                <el-form-item>
                    <el-button type="primary" size="small">搜索</el-button>
                    <el-button type="warning" size="small">导出</el-button>
                </el-form-item>
            </el-form>
        </div>
        <div class="tree-conten">
            <table border="1" width="auto" height="300" cellspacing="0" align="center">
                <tr>
                    <td>角色定位</td>

                    <td>职级</td>
                    <td colspan="4" rowspan="6">
                        <TreeChart
                            v-if="flag"
                            :json="treeData"
                            :class="{ landscape: isVertical }"
                            :isDetail="isDetail"
                            @add="addStock"
                            @delete="deleteStock"
                            @look="handleLook"
                        />
                        <SimpleChart
                            v-else
                            :json="treeData"
                            :class="{ landscape: isVertical }"
                            :isDetail="isDetail"
                            @add="addStock"
                            @delete="deleteStock"
                            @look="handleLook"
                        />
                    </td>
                </tr>

                <tr>
                    <td>正职</td>
                    <td>L1</td>
                </tr>
                <tr>
                    <td>副职</td>

                    <td>L2</td>
                </tr>

                <tr>
                    <td>下设主体正职</td>

                    <td>L2</td>
                </tr>
                <tr>
                    <td>下设主体副职/职能总监层</td>

                    <td>L3.1</td>
                </tr>
                <tr>
                    <td>高级经理层</td>

                    <td>L4.1 L4.2</td>
                </tr>
            </table>
        </div>
        <!-- 新增。编辑 -->
        <el-dialog title="提示" :visible.sync="dialogVisible" @close="clearDialog" :close-on-click-modal="false" width="500px">
            <div class="tips">
                <el-form :model="ruleForm" :rules="rules" ref="ruleForm" class="demo-ruleForm">
                    <el-form-item label="行政职务" prop="type">
                        <el-select v-model="ruleForm.type" placeholder="行政职务" @change="changeType">
                            <el-option v-for="item in shareholderTypeOptions" :key="item.value" :label="item.labelZh" :value="item.value">
                            </el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="姓名" prop="partnerName">
                        <el-input placeholder="输入姓名" :maxlength="32" v-model="ruleForm.partnerName"></el-input>
                    </el-form-item>
                    <el-form-item label="任期时间" prop="proportionShares">
                        <el-input placeholder="任期时间" :maxlength="5" v-model="ruleForm.proportionShares"></el-input>
                    </el-form-item>
                </el-form>
            </div>
            <span slot="footer" class="dialog-footer">
                <div class="tip-left">
                    <el-button type="info" @click="dialogVisible = false">取消</el-button>
                    <el-button type="primary" @click="confirm">确定</el-button>
                </div>
            </span>
        </el-dialog>

        <!-- 删除提示弹框 -->
        <el-dialog title="提示" :visible.sync="dialogVisible2" width="30%">
            <div class="tips">
                <p style="text-align: left">确定删除该信息?</p>
            </div>
            <span slot="footer" class="dialog-footer">
                <div class="tip-left">
                    <el-button type="info" @click="dialogVisible2 = false">取消</el-button>
                    <el-button type="primary" @click="confimdelete">确定</el-button>
                </div>
            </span>
        </el-dialog>
        <!-- 查看 -->
        <div class="leader_dialog">
            <el-dialog title="新增" :visible.sync="messageFlag" width="1000px">
                <el-tabs v-model="activeName" @tab-click="handleClick">
                    <el-tab-pane label="基本信息" name="first">
                        <div class="message">
                            <ul class="left">
                                <li>
                                    <b>姓名</b>
                                    <span>张三</span>
                                </li>
                                <li>
                                    <b>年龄</b>
                                    <span>23</span>
                                </li>
                                <li>
                                    <b>政治面貌</b>
                                    <span>群众</span>
                                </li>
                                <li>
                                    <b>民族</b>
                                    <span>汉族</span>
                                </li>
                                <li>
                                    <b>婚姻状况</b>
                                    <span>是</span>
                                </li>
                                <li>
                                    <b>最高学历</b>
                                    <span>本科</span>
                                </li>
                                <li>
                                    <b>档案所在地</b>
                                    <span>沙河工厂</span>
                                </li>
                                <li>
                                    <b>干部属性</b>
                                    <span>党委干部</span>
                                </li>
                                <li>
                                    <b>退休时间</b>
                                    <span>2022年10月12日</span>
                                </li>
                                <li>
                                    <b>党内职务</b>
                                    <span>委员</span>
                                </li>
                            </ul>
                            <ul class="right">
                                <li>
                                    <b>性别</b>
                                    <span>女</span>
                                </li>
                                <li>
                                    <b>出生日期</b>
                                    <span>2021年6月21日</span>
                                </li>
                                <li>
                                    <b>入党日期</b>
                                    <span>2021年6月21日</span>
                                </li>
                                <li>
                                    <b>籍贯</b>
                                    <span>河北</span>
                                </li>
                                <li>
                                    <b>第一学历</b>
                                    <span>本科</span>
                                </li>
                                <li>
                                    <b>身份证号</b>
                                    <span>64389</span>
                                </li>
                                <li>
                                    <b>人事关系地点</b>
                                    <span>总部</span>
                                </li>
                                <li>
                                    <b>办公地点</b>
                                    <span>北京昌平厂</span>
                                </li>
                                <li>
                                    <b>所属党组织</b>
                                    <span>**党委**党支部</span>
                                </li>
                            </ul>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="职务信息" name="second">
                        <div class="message">
                            <ul class="left">
                                <li>
                                    <b>单位</b>
                                    <span>福田</span>
                                </li>
                                <li>
                                    <b>职务</b>
                                    <span>经理</span>
                                </li>
                                <li>
                                    <b>职级</b>
                                    <span>L</span>
                                </li>
                                <li>
                                    <b>进入福田途径</b>
                                    <span>校招</span>
                                </li>
                                <li>
                                    <b>敏感岗位属性</b>
                                    <span>质量、采购、财务、品牌</span>
                                </li>
                                <li>
                                    <b>所需系统</b>
                                    <span>人力</span>
                                </li>
                                <li>
                                    <b>现岗位任职时间</b>
                                    <span>1年2个月</span>
                                </li>
                            </ul>
                            <ul class="right">
                                <li>
                                    <b>进入福田时间</b>
                                    <span>2021年6月21</span>
                                </li>
                                <li>
                                    <b>首次参加工作时间</b>
                                    <span>2021年6月21日</span>
                                </li>
                                <li>
                                    <b>社会工龄</b>
                                    <span>11年</span>
                                </li>
                                <li>
                                    <b>福田工龄</b>
                                    <span>3年</span>
                                </li>
                                <li>
                                    <b>主岗位、非主岗</b>
                                    <span>主岗位</span>
                                </li>
                                <li>
                                    <b>干部兼职情况</b>
                                    <span>内部兼职</span>
                                </li>
                                <li>
                                    <b>现岗位任命时间</b>
                                    <span>2021年1月12日</span>
                                </li>
                            </ul>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="工作经历" name="third">
                        <div class="message">
                            <el-table :data="workExper">
                                <el-table-column prop="num" label="序号"></el-table-column>
                                <el-table-column prop="time" label="时间"></el-table-column>
                                <el-table-column prop="unit" label="单位"></el-table-column>
                                <el-table-column prop="dept" label="部门"></el-table-column>
                                <el-table-column prop="position" label="职位"></el-table-column>
                                <el-table-column prop="system" label="所属系统"></el-table-column>
                            </el-table>
                            <!-- <ul class="left">
                                <li>2001年到2004年 就职于时代事业部</li>
                                <li>2004年到2021年 就职于普罗科事业部</li>
                            </ul> -->
                            <!-- <ul class="right">
                <li>
                  <b>来福田后工作经历</b>
                </li>
              </ul> -->
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="个人绩效" name="fourth">
                        <div class="jixiao">
                            <el-form :model="messageForm" :inline="true">
                                <el-form-item label="时间" prop="birthday">
                                    <el-date-picker
                                        style="width: 220px"
                                        v-model="messageForm.birthday"
                                        type="daterange"
                                        range-separator="至"
                                        start-placeholder="开始日期"
                                        end-placeholder="结束日期"
                                    >
                                    </el-date-picker>
                                </el-form-item>
                            </el-form>
                            <table border="1" width="auto" height="300" cellspacing="0" align="center">
                                <!-- colspan="2" -->

                                <tr>
                                    <td>绩效周期</td>
                                    <td>绩效类型</td>
                                    <td colspan="12">绩效结果</td>
                                </tr>
                                <tr>
                                    <td rowspan="6">2020年</td>
                                    <td colspan="2" rowspan="2">月度绩效</td>

                                    <td>1月</td>
                                    <td>2月</td>
                                    <td>3月</td>
                                    <td>4月</td>
                                    <td>5月</td>
                                    <td>7月</td>

                                    <td>8月</td>
                                    <td>9月</td>
                                    <td>10月</td>

                                    <td>11月</td>
                                    <td>12月</td>
                                    <!--rowspan 合并列-->
                                </tr>
                                <tr>
                                    <td>A(80%)</td>
                                    <td>A(80%)</td>
                                    <td>A(80%)</td>

                                    <td>A(80%)</td>
                                    <td>A(80%)</td>
                                    <td>A(80%)</td>

                                    <td>A(80%)</td>
                                    <td>A(80%)</td>
                                    <td>A(80%)</td>

                                    <td>A(80%)</td>
                                    <td>A(80%)</td>
                                </tr>
                                <tr>
                                    <!--colspan 合并行-->

                                    <td colspan="2" rowspan="2">季度绩效</td>
                                    <td colspan="3">一季度</td>

                                    <td colspan="3">二季度</td>

                                    <td colspan="3">三季度</td>

                                    <td colspan="3">四季度</td>
                                </tr>
                                <tr>
                                    <td>A(80%)</td>
                                    <td colspan="3">A(80%)</td>
                                    <!-- rowspan="2" -->

                                    <td colspan="3">A(80%)</td>

                                    <td colspan="3">A(80%)</td>

                                    <td colspan="3">A(80%)</td>

                                    <!--rowspan 合并列-->
                                </tr>
                                <tr>
                                    <td colspan="2" rowspan="2">年度绩效</td>
                                    <td colspan="11">2020年度</td>
                                </tr>
                                <tr>
                                    <td colspan="11">A(80%)</td>
                                </tr>
                            </table>
                        </div>
                    </el-tab-pane>

                    <el-tab-pane label="历次考评" name="five">
                        <div class="check">
                            <el-form :model="messageForm" :inline="true">
                                <el-form-item label="考评类型" prop="type">
                                    <el-select v-model="messageForm.type" placeholder="请选择">
                                        <el-option key="bbk" label="日常考评" value="bbk"></el-option>
                                        <el-option key="xtc" label="年度考评" value="xtc"></el-option>
                                        <el-option key="imoo" label="党委考评" value="imoo"></el-option>
                                    </el-select>
                                </el-form-item>

                                <el-form-item label="考评周期" prop="period">
                                    <el-date-picker
                                        style="width: 220px"
                                        v-model="messageForm.period"
                                        type="daterange"
                                        range-separator="至"
                                        start-placeholder="开始日期"
                                        end-placeholder="结束日期"
                                    >
                                    </el-date-picker>
                                </el-form-item>
                            </el-form>
                            <div class="check-content">
                                <el-table :data="historyData">
                                    <el-table-column prop="type" label="考评类型"></el-table-column>
                                    <el-table-column prop="name" label="考评名称"></el-table-column>
                                    <el-table-column prop="period" label="考评周期"></el-table-column>
                                    <el-table-column prop="time" label="考评完成时间"></el-table-column>
                                    <el-table-column prop="result" label="考评结果"></el-table-column>
                                    <el-table-column prop="note" label="备注">可编辑</el-table-column>
                                </el-table>
                                <div class="pagination">
                                    <el-pagination
                                        background
                                        layout="total, prev, pager, next"
                                        :current-page="query.pageIndex"
                                        :page-size="query.pageSize"
                                        :total="pageTotal"
                                        @current-change="handlePageChange"
                                    ></el-pagination>
                                </div>
                            </div>
                        </div>
                    </el-tab-pane>
                    <el-tab-pane label="社会关系及主要家庭成员" name="six">
                        <el-table :data="familyData">
                            <el-table-column prop="title" label="称谓">
                                <template>
                                    <el-select v-model="familyTitle">
                                        <el-option key="6" label="父亲" value="6"></el-option>
                                        <el-option key="7" label="母亲" value="7"></el-option>
                                        <el-option key="1" label="配偶" value="1"></el-option>
                                        <el-option key="2" label="父女" value="2"></el-option>
                                        <el-option key="3" label="父子" value="3"></el-option>
                                        <el-option key="4" label="母女" value="4"></el-option>
                                        <el-option key="5" label="母子" value="5"></el-option>
                                    </el-select>
                                </template>
                            </el-table-column>
                            <el-table-column prop="name" label="姓名" width="auto"></el-table-column>
                            <el-table-column prop="sex" label="性别" width="auto"></el-table-column>
                            <el-table-column prop="age" label="年龄" width="auto"></el-table-column>
                            <el-table-column prop="nation" label="民族"></el-table-column>
                            <el-table-column prop="brithday" label="出生日期"></el-table-column>
                            <el-table-column prop="politics" label="政治面貌">
                                <template>
                                    <el-select v-model="politicsTitle">
                                        <el-option key="4" label="党员" value="4"></el-option>
                                        <el-option key="5" label="预备党员" value="5"></el-option>
                                        <el-option key="1" label="团员" value="1"></el-option>
                                        <el-option key="2" label="群众" value="2"></el-option>
                                        <el-option key="3" label="其他" value="3"></el-option>
                                    </el-select>
                                </template>
                            </el-table-column>
                            <el-table-column prop="unit" label="工作单位及职务"></el-table-column>

                            <el-table-column prop="address" label="现居住地址"></el-table-column>
                            <el-table-column prop="note" label="备注"></el-table-column>
                        </el-table>
                    </el-tab-pane>
                    <el-tab-pane label="兼职情况" name="seven">
                        <div class="">
                            <el-form v-model="messageForm">
                                <el-form-item label="兼职类型" prop="dutyType">
                                    <el-select v-model="messageForm.dutyType" placeholder="请选择" @change="handleChange">
                                        <el-option key="0" label="全部" value="0"></el-option>
                                        <el-option key="1" label="董监事兼职" value="1"></el-option>
                                        <el-option key="2" label="外部兼职" value="2"></el-option>
                                    </el-select>
                                </el-form-item>
                            </el-form>
                            <!-- <p>报告人董监事兼职情况</p> -->
                            <el-table :data="partData" v-if="partFlag">
                                <el-table-column prop="name" label="兼职类型"></el-table-column>
                                <el-table-column prop="partName" label="兼职企业名称及兼职职务"></el-table-column>
                                <el-table-column prop="partTime" label="兼职时间"></el-table-column>
                                <el-table-column prop="money" label="兼职薪酬情况（金额）"></el-table-column>
                                <el-table-column prop="note" label="备注"></el-table-column>
                            </el-table>
                            <!-- <p>报告人外部兼职情况</p> -->
                            <el-table :data="externalData" v-if="externalFlag">
                                <el-table-column prop="name" label="兼职类型"></el-table-column>
                                <el-table-column prop="partName" label="兼职企业名称及兼职职务"></el-table-column>

                                <el-table-column prop="unit" label="上级主管单位"></el-table-column>
                                <el-table-column prop="partTime" label="兼职时间"></el-table-column>

                                <el-table-column prop="nums" label="兼职届数"></el-table-column>
                                <el-table-column prop="money" label="兼职薪酬情况（金额）"></el-table-column>
                                <el-table-column prop="note" label="备注"></el-table-column>
                            </el-table>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </el-dialog>
        </div>
    </div>
</template>

<script>
import TreeChart from './comp.vue';

import SimpleChart from './simp.vue';
import { Loading } from 'element-ui';

export default {
    name: 'tree',
    components: {
        TreeChart,
        SimpleChart
    },
    data() {
        return {
            flag: true,
            ruleForm: {
                dept: '',
                rank: '',
                showType: ''
            },
            //展示类型
            showOption: [
                {
                    showValue: '1',
                    showLabel: '全部'
                },
                {
                    showValue: '2',
                    showLabel: '部分'
                }
            ],
            //显示类型
            typeOption: [
                {
                    typeValue: '1',
                    typeLabel: '照片版'
                },
                {
                    typeValue: '2',
                    typeLabel: '简化版'
                }
            ],
            deptOption: [
                {
                    deptValue: '1',
                    deptLabel: '集团领导层'
                },
                {
                    deptValue: '2',
                    deptLabel: '其他'
                },
                {
                    deptValue: '3',
                    deptLabel: '集团只能/业务副总裁'
                },
                {
                    deptValue: '4',
                    deptLabel: 'BU'
                },
                {
                    deptValue: '5',
                    deptLabel: 'FU'
                },
                {
                    deptValue: '6',
                    deptLabel: 'SBU'
                },
                {
                    deptValue: '7',
                    deptLabel: 'C'
                }
            ],
            activeName: 'first',
            messageFlag: false,
            messageForm: {
                birthday: '',
                period: '',
                type: '',
                dutyType: ''
            },
            tableData: [
                {
                    unit: 'xx事业部',
                    name: '张三',
                    sex: '男',
                    duty: '经理',
                    rank: 'L2',
                    age: '21',
                    credentials: '本科',
                    birthday: '1897年6月21日',
                    politicsStatus: '群众',
                    time: '2021年6月21日'
                }
            ],
            //家庭关系
            familyData: [
                {
                    title: '父亲',
                    name: '张三',
                    age: '41',
                    brithday: '1918年8月12日',
                    politics: '党员',
                    unit: '沙河镇',
                    sex: '男',
                    nation: '汉族',
                    address: '北京市昌平区沙河镇',
                    note: ''
                }
            ],
            familyTitle: '',
            politicsTitle: '',
            //工作经历
            workExper: [
                {
                    num: 1,
                    time: '2021年6月30日',
                    unit: 'xx事业部',
                    dept: '信息技术部',
                    position: '任xxx高级经理',
                    system: ''
                }
            ],
            //历史考评
            historyData: [
                {
                    type: '日常考评',
                    name: '招聘试用期考评',
                    period: '2002-01~2002-04',
                    time: '2021年6月30日11:09:15',
                    result: '优秀/良好/合格/有差距',
                    note: ''
                },
                {
                    type: '年度考评',
                    name: '2021年度考评',
                    period: '2020-01~2021-01',
                    time: '2021年6月30日',
                    result: '',
                    note: '优秀/良好/合格/有差距'
                },
                {
                    type: '党委 考评',
                    name: '党组织书记抓基层党建述职评议 ',
                    period: '',
                    time: '2021.1.13',
                    result: '优秀/良好/合格/有差距',
                    note: ''
                }
            ],
            //个人绩效
            perforData: [],
            //社会兼职情况
            partData: [
                {
                    name: '董监事兼职',
                    partTime: '经理',
                    partName: '1个月',
                    money: '1000',
                    note: ''
                }
            ],
            //报告人外部兼职情况
            externalData: [
                {
                    name: '外部兼职',
                    partTime: '2021年6月30日',
                    partName: '经理',
                    money: '1000',
                    note: '',
                    unit: 'xx事业部',
                    nums: '1'
                }
            ],
            treeData: {
                partnerName: '行政职务',
                name: '姓名',
                headImg: '../../assets/img/figure.png',
                time: '任期时间',
                age: '年龄',
                work: '主持事业部/部门全面工作',
                proportionShares: '20',
                partnerType: 2,
                id: 1,
                // partnerCode: 1,
                // // proportionShares: '100',
                // partnerType: 2,
                // id: 1,
                childers: [
                    {
                        partnerName: '职务职务',
                        name: '姓名',
                        headImg: '../../assets/img/figure.png',
                        time: '任期时间',
                        age: '年龄',
                        work: '主持事业部/部门全面工作',
                        id: 2,
                        proportionShares: '20',
                        partnerCode: 1,
                        childers: [
                            {
                                partnerName: '技术中心主任',
                                name: '姓名',
                                headImg: '../../assets/img/figure.png',
                                time: '任期时间',
                                age: '年龄',
                                id: 4,
                                proportionShares: '20',
                                partnerCode: 2,
                                childers: [
                                    {
                                        partnerName: '职务职务',
                                        name: '姓名',
                                        headImg: '../../assets/img/figure.png',
                                        time: '任期时间',
                                        age: '年龄',
                                        id: 6,
                                        proportionShares: '20',
                                        partnerCode: 2
                                    },
                                    {
                                        partnerName: '职务职务',
                                        name: '姓名',
                                        headImg: '../../assets/img/figure.png',
                                        time: '任期时间',
                                        age: '年龄',
                                        id: 7,
                                        proportionShares: '20',
                                        partnerCode: 2
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        partnerName: '职务职务',
                        name: '姓名',
                        headImg: '../../assets/img/figure.png',
                        time: '任期时间',
                        age: '年龄',
                        work: '主持事业部/部门全面工作',
                        id: 3,
                        proportionShares: '20',
                        partnerCode: 1,
                        childers: [
                            {
                                partnerName: '工厂厂长',
                                name: '姓名',
                                headImg: '../../assets/img/figure.png',
                                time: '任期时间',
                                age: '年龄',
                                id: 5,
                                proportionShares: '20',
                                partnerCode: 3,
                                childers: [
                                    {
                                        partnerName: '职务职务',
                                        name: '姓名',
                                        headImg: '../../assets/img/figure.png',
                                        time: '任期时间',
                                        age: '年龄',
                                        id: 8,
                                        proportionShares: '20',
                                        partnerCode: 3
                                    },
                                    {
                                        partnerName: '职务职务',
                                        name: '姓名',
                                        headImg: '../../assets/img/figure.png',
                                        time: '任期时间',
                                        age: '年龄',
                                        id: 9,
                                        proportionShares: '20',
                                        partnerCode: 3
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            query: {
                address: '',
                name: '',
                pageIndex: 1,
                pageSize: 10
            },
            pageTotal: 0,
            partFlag: true,
            externalFlag: true,
            isVertical: false, // 是否是竖方向,只给最外层的添加
            isDetail: false, // 是否是详情,不可编辑操作
            dialogVisible: false, // 添加股东弹框
            dialogVisible2: false, // 删除提示弹框
            ruleForm: {
                type: 1,
                partnerName: '',
                proportionShares: null
            },
            rules: {
                proportionShares: [{ required: true, message: '请输入比例', trigger: 'blur' }],
                partnerName: [{ required: true, message: '请输入股东名称', trigger: 'blur' }],
                cardId: [{ required: true, message: '请输入证件号', trigger: 'blur' }],
                type: [{ required: true, message: '请选择类型', trigger: 'blur' }]
            },
            shareholderTypeOptions: [
                {
                    labelEn: 'Individual',
                    labelZh: '个人',
                    value: 1
                },
                {
                    labelEn: 'Company',
                    labelZh: '公司',
                    value: 2
                },
                {
                    labelEn: 'Other',
                    labelZh: '其他',
                    value: 3
                }
            ], // 股东类型
            lastId: 11, // 最后一级id
            currentTreeData: {}
        };
    },
    methods: {
        changeType() {},
        clearDialog() {},
        // 新增编辑股东,val: 0 新增, 1 编辑
        addStock(data) {
            // console.log(data)
            if (data.val) {
                // 不使用=赋值,内存相同,改变后,treeData数据也会改变
                // this.ruleForm = data.data;
                this.ruleForm = Object.assign(this.ruleForm, data.data);
                this.ruleForm.type = data.data.partnerType;
            }
            this.isEdit = data.val;
            // 使用=赋值,编辑时改变currentTreeData, 源数据treeData也会改变
            this.currentTreeData = data.data;
            this.dialogVisible = true;
        },
        // 删除
        deleteStock(data) {
            // console.log(data)
            this.currentTreeData = data;
            this.dialogVisible2 = true;
        },
        // 确定删除
        confimdelete() {
            // 前端删除 遍历原数据,删除匹配id数据
            const deleteData = (data) => {
                data.some((item, i) => {
                    if (item.id === this.currentTreeData.id) {
                        data.splice(i, 1);
                        return;
                    } else if (item.childers) {
                        deleteData(item.childers);
                    }
                });
            };
            let arr = [this.treeData];
            deleteData(arr);
            this.treeData = arr[0] ? arr[0] : {};
            // console.log(this.treeData)
            this.dialogVisible2 = false;
            this.$message({
                type: 'success',
                message: '成功'
            });
        },

        // 保存添加股东
        confirm() {
            let loading = Loading.service();
            this.$refs.ruleForm.validate((valid) => {
                if (valid) {
                    this.sendData();
                } else {
                    loading.close();
                }
            });
        },

        // 发送添加股东数据
        sendData() {
            let loading = Loading.service();
            let data = {
                partnerType: this.ruleForm.type,
                partnerName: this.ruleForm.partnerName,
                proportionShares: this.ruleForm.proportionShares
            };
            if (this.isEdit) {
                // 编辑
                // data.id = this.treeData.id;
                this.currentTreeData.partnerType = data.partnerType;
                this.currentTreeData.partnerName = data.partnerName;
                this.currentTreeData.proportionShares = data.proportionShares;
                // 前端编辑数据
                this.$message({
                    type: 'success',
                    message: '成功'
                });
                this.clearDialog();
                loading.close();
            } else {
                // 添加
                // 前端添加数据,需要自己生成子级id,可以传数据的时候把最后一级id传过来,进行累加
                data.id = this.lastId++;
                data.partnerCode = this.currentTreeData.id;
                data.extend = true;
                const render = (formData) => {
                    formData.some((item) => {
                        if (item.id === this.currentTreeData.id) {
                            if (item.childers) {
                                item.childers.push(data);
                            } else {
                                this.$set(item, 'childers', [data]);
                            }
                            return;
                        } else if (item.childers) {
                            render(item.childers);
                        }
                    });
                };
                let arr = [this.treeData];
                render(arr);
                this.treeData = arr[0];

                this.$message({
                    type: 'success',
                    message: '成功'
                });
                this.clearDialog();
                loading.close();
            }
        },
        handleLook() {
            console.log(1);
            this.messageFlag = true;
            console.log(this.messageFlag);
        },
        submitForm() {},
        // 分页导航
        handlePageChange(val) {
            this.$set(this.query, 'pageIndex', val);
            this.getData();
        },
        handleClick(tab, event) {
            console.log(tab, event);
        },
        handleChange(e) {
            if (e == 1) {
                this.partFlag = true;
                this.externalFlag = false;
            } else if (e == 2) {
                this.partFlag = false;
                this.externalFlag = true;
            } else {
                this.partFlag = true;
                this.externalFlag = true;
            }
        },
        ChangeType(e) {
            if (e == 1) {
                this.flag = true;
            } else {
                this.flag = false;
            }
            console.log(e);
        }
    }
};
</script>
<style lang="less" scoped>
.tree {
    width: 100%;
    height: 100%;

    .tree-conten {
        margin: auto;
        margin-left: 20%;
        // td {
        //     display: flex;
        //     align-items: center;
        //     justify-content: center;
        // }
    }
}
.message {
    width: 100%;
    display: flex;
    justify-content: space-between;
}
.message li {
    line-height: 30px;
}
.message li b {
    font-weight: normal;
    display: inline-block;
    width: 140px;
}
.jixiao td {
    text-align: center;
    width: 85px;
}
</style>